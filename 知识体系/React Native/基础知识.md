

# 简介

React Native 是一个使用 **react**  和 **应用平台的原生功能** 来构建Android和iOS应用的开源框架。通过RN，开源使用JavaScript来访问**移动平台的API**，以及使用**React组件**来描述UI的**外观**和**行为**.

Q1，组件在React Native中是如果工作的？

## 视图

在移动开发中，一个**视图**是UI的基本组成部分：屏幕上一个小矩形元素、文本、图像或响应用户输入。某些类型的视图可以包含其它视图。

## 原生组件

在Android开发中是使用kotlin或Java来编写视图；

在iOS开发中是使用Swift或Object-C来编写视图；

在RN中，则使用React组件通过**JavaScript**来调用这些视图。在运行时，RN为这些组件创建相应的Android和iOS视图。由于RN组件就是**对原生视图的封装**，因此使用React Native编写应用外观、感觉性能和其他任何原生应用一样；

我们将这些平台支持的组件称为**原生组件**；

React Native允许你为Android和iOS构建自己的native components（原生组件），RN还包括一组基本，随时可用的原生组件，这些是**核心组件**。

## 核心组件

React Native 具有许多核心组件，从表单控件到活动指示器，应有尽有。将主要使用以下核心组件：

| REACT NATIVE UI 组件 | ANDROID 原生视图 | IOS 原生视图     | WEB 标签                | 说明                                                         |
| :------------------- | :--------------- | :--------------- | :---------------------- | :----------------------------------------------------------- |
| `<View>`             | `<ViewGroup>`    | `<UIView>`       | A non-scrolling `<div>` | 一个支持使用flexbox布局、样式、一些触摸处理和无障碍性控件的容器 |
| `<Text>`             | `<TextView>`     | `<UITextView>`   | `<p>`                   | 显示、样式和嵌套文本字符串，甚至处理触摸事件                 |
| `<Image>`            | `<ImageView>`    | `<UIImageView>`  | `<img>`                 | 显示不同类型的图片                                           |
| `<ScrollView>`       | `<ScrollView>`   | `<UIScrollView>` | `<div>`                 | 一个通用的滚动容器，可以包含多个组件和视图                   |
| `<TextInput>`        | `<EditText>`     | `<UITextField>`  | `<input type="text">`   | 使用户可以输入文本                                           |

## 自定义组件

例子

```jsx
import React from 'react';
import { Text, TextInput, View } from 'react-native';

const Cat = () => {
  return (
    <View>
      <Text>Hello, I am...</Text>
      <TextInput
        style={{
          height: 40,
          borderColor: 'gray',
          borderWidth: 1
        }}
        defaultValue="Name me!"
      />
    </View>
  );
}

export default Cat;
```

tips：在 Android 上，常见的做法是把视图放入`LinearLayout`, `FrameLayout`或是`RelativeLayout`等布局容器中来定义子元素如何排列。在 React Native 中， `View` 使用弹性盒模型（Flexbox）来为子元素布局。详情请参考使用 **Flexbox** 布局。

**注意**：

请留意在指定`style`属性的宽高时所用到的双层括号`{{ }}`。在 JSX 中，引用 JS 值时需要使用`{}`括起来。在你需要传递非字符串值（比如数组或者数字）的时候会经常用到这种写法：`<Cat food={["fish", "kibble"]} age={2} /> `。然而我们在 JS 中定义一个对象时，本来也需要用括号括起来：`{width: 200, height: 200}`。因此要在 JSX 中传递一个 JS 对象值的时候，就必须用到两层括号：`{{width: 200, height: 200}}`。

**与react 组件关系**

**react 组件**包含以下组件：

- 原生组件
- 核心组件
- 社区组件
- 自定义原生组件

## demo

使用各种原生组件的案例

```jsx
import React from 'react';
import { View, Text, Image, ScrollView, TextInput } from 'react-native';

const App = () => {
  return (
    <ScrollView>
      <Text>Some text</Text>
      <View>
        <Text>Some more text</Text>
        <Image
          source={{
            uri: 'https://reactnative.dev/docs/assets/p_cat2.png',
          }}
          style={{ width: 200, height: 200 }}
        />
      </View>
      <TextInput
        style={{
          height: 40,
          borderColor: 'gray',
          borderWidth: 1
        }}
        defaultValue="You can type in me"
      />
    </ScrollView>
  );
}

export default App;
```

使用{}的案例

```jsx
import React from 'react';
import { Text } from 'react-native';

const getFullName = (firstName, secondName, thirdName) => {
  return firstName + " " + secondName + " " + thirdName;
}

const Cat = () => {
  return (
    <Text>
      Hello, I am {getFullName("Rum", "Tum", "Tugger")}!
    </Text>
  );
}

export default Cat;
```

你可以把括号`{}`想象成在 JSX 中打开了一个可以调用 JS 功能的传送门！

在 **React Native 0.71** 版本之前，JSX 语法糖的实质是调用`React.createElement`方法，所以你必须在文件头部引用`import React from 'react'`。但在 React Native 0.71 版本之后，官方引入了**新的 JSX 转换**，可以**不用**在文件头部写`import React from 'react'`。

## 新的jsx转换

在浏览器中无法直接使用 **JSX**，所以大多数 React 开发者需依靠 **Babel** 或 **TypeScript** 来**将 JSX 代码转换为 JavaScript**。许多包含预配置的工具，例如 Create React App 或 Next.js，在其内部也引入了 JSX 转换。

**新旧转换有什么不同？**

当你使用 JSX 时，编译器会将其转换为浏览器可以理解的 React 函数调用；

**旧的 JSX 转换**会把 JSX 转换为 `React.createElement(...)` 调用。

例如

```jsx
import React from 'react';

function App() {
  return <h1>Hello World</h1>;
}
```

旧的 JSX 转换会将上述代码变成普通的 JavaScript 代码：

```js
import React from 'react';

function App() {
  return React.createElement('h1', null, 'Hello world');
}
```

然而，这并不完美：

- 如果使用 JSX，则需在 `React` 的环境下，因为 JSX 将被编译成 `React.createElement`。
- 有一些 `React.createElement` 无法做到的 **性能优化和简化**。

为了解决这些问题，React 17 在 React 的 package 中引入了两个新入口，这些入口只会被 Babel 和 TypeScript 等编译器使用。新的 JSX 转换**不会将 JSX 转换为 `React.createElement`**，而是自动从 React 的 package 中引入新的入口函数并调用

假设你的代码是

```js
function App() {
  return <h1>Hello World</h1>;
}
```

新 JSX 转换编译后的结果：

```jsx
// 由编译器引入（禁止自己引入！）
import {jsx as _jsx} from 'react/jsx-runtime';

function App() {
  return _jsx('h1', { children: 'Hello world' });
}
```

# **搭建环境**

- node.js
- react native cli
- 模拟器或设备

